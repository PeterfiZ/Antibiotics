window.test_hu = [
    // Farmakológiai - Könnyű
    {
        "id": 1, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik csoportba tartozik a Meropenem?",
        "answers": [ { "text": "Karbapenem", "correct": true }, { "text": "Penicillin", "correct": false }, { "text": "Cefalosporin", "correct": false }, { "text": "Glikopeptid", "correct": false } ]
    },
    {
        "id": 2, "topic": "pharmacological", "difficulty": "easy", "question": "Mi a Gentamicin hatásmechanizmusa?",
        "answers": [ { "text": "Protein szintézis gátló (30S riboszóma)", "correct": true }, { "text": "Sejtfal szintézis gátló (PBP kötés)", "correct": false }, { "text": "DNS giráz gátló", "correct": false }, { "text": "Folsav szintézis gátló", "correct": false } ]
    },
    {
        "id": 13, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik csoportba tartozik a Ciprofloxacin?",
        "answers": [ { "text": "Fluorokinolon", "correct": true }, { "text": "Makrolid", "correct": false }, { "text": "Aminoglikozid", "correct": false }, { "text": "Tetracyclin", "correct": false } ]
    },
    {
        "id": 14, "topic": "pharmacological", "difficulty": "easy", "question": "Mi az Amoxicillin hatásmechanizmusa?",
        "answers": [ { "text": "Sejtfal szintézis gátló (PBP kötés)", "correct": true }, { "text": "Protein szintézis gátló (50S riboszóma)", "correct": false }, { "text": "DNS giráz gátló", "correct": false }, { "text": "Membrán depolarizáció", "correct": false } ]
    },
    {
        "id": 15, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik csoportba tartozik a Doxycycline?",
        "answers": [ { "text": "Tetracyclin", "correct": true }, { "text": "Glikopeptid", "correct": false }, { "text": "Penicillin", "correct": false }, { "text": "Lincosamid", "correct": false } ]
    },
    {
        "id": 31, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik antibiotikum gátolja a DNS giráz enzimet?",
        "answers": [ { "text": "Ciprofloxacin", "correct": true }, { "text": "Penicillin G", "correct": false }, { "text": "Vancomycin", "correct": false }, { "text": "Erythromycin", "correct": false } ]
    },
    {
        "id": 32, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik antibiotikum hat a fehérjeszintézisre az 50S riboszomális alegységen keresztül?",
        "answers": [ { "text": "Clindamycin", "correct": true }, { "text": "Gentamicin", "correct": false }, { "text": "Ciprofloxacin", "correct": false }, { "text": "Penicillin G", "correct": false } ]
    },
    // Farmakológiai - Nehéz
    {
        "id": 3, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik jellemző mellékhatása a Vancomycin-nak/nek?",
        "answers": [ { "text": "Red man szindróma", "correct": true }, { "text": "Ínszakadás", "correct": false }, { "text": "Sárga fogak", "correct": false }, { "text": "Pulmonális fibrosis", "correct": false } ]
    },
    {
        "id": 4, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik antibiotikum hatékony <i>Pseudomonas aeruginosa</i> ellen?",
        "answers": [ { "text": "Ceftazidime", "correct": true }, { "text": "Amoxicillin", "correct": false }, { "text": "Erythromycin", "correct": false }, { "text": "Penicillin G", "correct": false } ]
    },
    {
        "id": 16, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik a legjellemzőbb mellékhatása a Clindamycin-nak/nek?",
        "answers": [ { "text": "Pseudomembranosus colitis (CDAD)", "correct": true }, { "text": "Vesekárosodás", "correct": false }, { "text": "Halláskárosodás", "correct": false }, { "text": "QT-megnyúlás", "correct": false } ]
    },
    {
        "id": 17, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik antibiotikum hatékony MRSA ellen?",
        "answers": [ { "text": "Vancomycin", "correct": true }, { "text": "Ceftriaxone", "correct": false }, { "text": "Ampicillin", "correct": false }, { "text": "Ciprofloxacin", "correct": false } ]
    },
    {
        "id": 18, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik jellemző mellékhatása az aminoglikozidoknak (pl. Gentamicin)?",
        "answers": [ { "text": "Nephrotoxicitás és ototoxicitás", "correct": true }, { "text": "Hepatotoxicitás", "correct": false }, { "text": "Fotoszenzitivitás", "correct": false }, { "text": "Csontvelő szuppresszió", "correct": false } ]
    },
    {
        "id": 33, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik antibiotikumot inaktiválja a tüdő surfaktáns, ezért nem használható pneumonia kezelésére?",
        "answers": [ { "text": "Daptomycin", "correct": true }, { "text": "Linezolid", "correct": false }, { "text": "Vancomycin", "correct": false }, { "text": "Ceftriaxone", "correct": false } ]
    },
    {
        "id": 34, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik gyógyszer okozhat disulfiram-szerű reakciót alkohollal együtt fogyasztva?",
        "answers": [ { "text": "Metronidazol", "correct": true }, { "text": "Amoxicillin", "correct": false }, { "text": "Doxycycline", "correct": false }, { "text": "Azithromycin", "correct": false } ]
    },
    // Klinikai - Könnyű
    {
        "id": 5, "topic": "clinical", "difficulty": "easy", "question": "Melyik gyakori kórokozója a purulens meningitisnek (felnőtt)?",
        "answers": [ { "text": "Streptococcus pneumoniae", "correct": true }, { "text": "Staphylococcus epidermidis", "correct": false }, { "text": "Clostridium difficile", "correct": false }, { "text": "Candida albicans", "correct": false } ]
    },
    {
        "id": 6, "topic": "clinical", "difficulty": "easy", "question": "Melyik a leggyakoribb kórokozója az akut cystitisnek (nők)?",
        "answers": [ { "text": "Escherichia coli", "correct": true }, { "text": "Pseudomonas aeruginosa", "correct": false }, { "text": "Staphylococcus aureus", "correct": false }, { "text": "Legionella pneumophila", "correct": false } ]
    },
    {
        "id": 19, "topic": "clinical", "difficulty": "easy", "question": "Melyik gyakori kórokozója a kórházban szerzett pneumoniának (HAP)?",
        "answers": [ { "text": "Pseudomonas aeruginosa", "correct": true }, { "text": "Streptococcus pyogenes", "correct": false }, { "text": "Mycoplasma pneumoniae", "correct": false }, { "text": "Haemophilus influenzae", "correct": false } ]
    },
    {
        "id": 20, "topic": "clinical", "difficulty": "easy", "question": "Melyik a leggyakoribb kórokozója a cellulitisnek?",
        "answers": [ { "text": "Streptococcus pyogenes", "correct": true }, { "text": "Escherichia coli", "correct": false }, { "text": "Enterococcus faecalis", "correct": false }, { "text": "Bacteroides fragilis", "correct": false } ]
    },
    {
        "id": 21, "topic": "clinical", "difficulty": "easy", "question": "Melyik gyakori kórokozója a natív billentyű endocarditisnek?",
        "answers": [ { "text": "Viridans streptococcusok", "correct": true }, { "text": "Acinetobacter baumannii", "correct": false }, { "text": "Candida albicans", "correct": false }, { "text": "Serratia marcescens", "correct": false } ]
    },
    {
        "id": 35, "topic": "clinical", "difficulty": "easy", "question": "Melyik a leggyakoribb kórokozója a spontán bakteriális peritonitisnek (SBP)?",
        "answers": [ { "text": "E. coli", "correct": true }, { "text": "S. aureus", "correct": false }, { "text": "P. aeruginosa", "correct": false }, { "text": "Enterococcus faecium", "correct": false } ]
    },
    {
        "id": 36, "topic": "clinical", "difficulty": "easy", "question": "Melyik kategóriába tartozik a Spondylodiscitis?",
        "answers": [ { "text": "Ortopédiai", "correct": true }, { "text": "Légzőrendszeri", "correct": false }, { "text": "Központi idegrendszeri", "correct": false }, { "text": "Bőr és lágyrészek", "correct": false } ]
    },
    // Klinikai - Nehéz
    {
        "id": 7, "topic": "clinical", "difficulty": "hard", "question": "Mi az első vonalbeli empirikus terápia CAP - Otthon kezelhető (alacsony rizikó) esetén?",
        "answers": [ { "text": "Amoxicillin 1g PO 8h", "correct": true }, { "text": "Vancomycin IV", "correct": false }, { "text": "Meropenem IV", "correct": false }, { "text": "Piperacillin-tazobactam IV", "correct": false } ]
    },
    {
        "id": 8, "topic": "clinical", "difficulty": "hard", "question": "Mi az első vonalbeli empirikus terápia közösségben szerzett szepszis esetén?",
        "answers": [ { "text": "Piperacillin-tazobactam + Vancomycin", "correct": true }, { "text": "Amoxicillin", "correct": false }, { "text": "Doxycycline", "correct": false }, { "text": "Clindamycin", "correct": false } ]
    },
    {
        "id": 22, "topic": "clinical", "difficulty": "hard", "question": "Mi az első vonalbeli terápia Necrotizáló fasciitis esetén?",
        "answers": [ { "text": "Clindamycin + Penicillin G + Sebészeti debridement", "correct": true }, { "text": "Csak Vancomycin", "correct": false }, { "text": "Ciprofloxacin + Metronidazol", "correct": false }, { "text": "Csak sebészeti debridement", "correct": false } ]
    },
    {
        "id": 23, "topic": "clinical", "difficulty": "hard", "question": "Mi az empirikus terápia korai (<1 év) protézis billentyű endocarditis esetén?",
        "answers": [ { "text": "Vancomycin + Gentamicin + Rifampin", "correct": true }, { "text": "Penicillin G", "correct": false }, { "text": "Ceftriaxone + Azithromycin", "correct": false }, { "text": "Ampicillin + Sulbactam", "correct": false } ]
    },
    {
        "id": 24, "topic": "clinical", "difficulty": "hard", "question": "Mi az elsődleges terápia *Clostridioides difficile* fertőzés esetén?",
        "answers": [ { "text": "Fidaxomicin (PO)", "correct": true }, { "text": "Metronidazol (IV)", "correct": false }, { "text": "Ceftriaxone (IV)", "correct": false }, { "text": "Clindamycin (PO)", "correct": false } ]
    },
    {
        "id": 37, "topic": "clinical", "difficulty": "hard", "question": "Milyen terápiát igényel a neutropéniás láz, ha 4-7 nap után is fennáll a láz?",
        "answers": [ { "text": "Antifungális terápia hozzáadása", "correct": true }, { "text": "Antibiotikum leállítása", "correct": false }, { "text": "Dóziscsökkentés", "correct": false }, { "text": "Váltás orális antibiotikumra", "correct": false } ]
    },
    {
        "id": 38, "topic": "clinical", "difficulty": "hard", "question": "Melyik gyógyszerkombináció javasolt *Listeria monocytogenes* meningitis esetén?",
        "answers": [ { "text": "Ampicillin + Gentamicin", "correct": true }, { "text": "Vancomycin + Ceftriaxone", "correct": false }, { "text": "Meropenem", "correct": false }, { "text": "Penicillin G", "correct": false } ]
    },
    // Mikrobiológiai - Könnyű
    {
        "id": 9, "topic": "microbiological", "difficulty": "easy", "question": "Milyen típusú kórokozó a <i>Staphylococcus aureus</i>?",
        "answers": [ { "text": "Gram-pozitív coccus", "correct": true }, { "text": "Gram-negatív bacillus", "correct": false }, { "text": "Spirocheta", "correct": false }, { "text": "Gomba", "correct": false } ]
    },
    {
        "id": 10, "topic": "microbiological", "difficulty": "easy", "question": "Milyen típusú kórokozó az <i>Escherichia coli</i>?",
        "answers": [ { "text": "Gram-negatív bacillus", "correct": true }, { "text": "Gram-pozitív coccus", "correct": false }, { "text": "Anaerob", "correct": false }, { "text": "Atípusos", "correct": false } ]
    },
    {
        "id": 25, "topic": "microbiological", "difficulty": "easy", "question": "Milyen típusú kórokozó a <i>Streptococcus pyogenes</i>?",
        "answers": [ { "text": "Gram-pozitív coccus", "correct": true }, { "text": "Gram-negatív coccus", "correct": false }, { "text": "Gram-pozitív bacillus", "correct": false }, { "text": "Spirocheta", "correct": false } ]
    },
    {
        "id": 26, "topic": "microbiological", "difficulty": "easy", "question": "Milyen típusú kórokozó a <i>Pseudomonas aeruginosa</i>?",
        "answers": [ { "text": "Gram-negatív bacillus", "correct": true }, { "text": "Gram-pozitív bacillus", "correct": false }, { "text": "Anaerob", "correct": false }, { "text": "Gomba", "correct": false } ]
    },
    {
        "id": 27, "topic": "microbiological", "difficulty": "easy", "question": "Milyen típusú kórokozó a <i>Candida albicans</i>?",
        "answers": [ { "text": "Gomba", "correct": true }, { "text": "Gram-pozitív coccus", "correct": false }, { "text": "Atípusos", "correct": false }, { "text": "Vírus", "correct": false } ]
    },
    {
        "id": 39, "topic": "microbiological", "difficulty": "easy", "question": "Melyik baktérium képez biofilmet, ami megnehezíti a kezelést?",
        "answers": [ { "text": "Staphylococcus epidermidis", "correct": true }, { "text": "Streptococcus pyogenes", "correct": false }, { "text": "Haemophilus influenzae", "correct": false }, { "text": "Moraxella catarrhalis", "correct": false } ]
    },
    {
        "id": 40, "topic": "microbiological", "difficulty": "easy", "question": "Melyik kórokozó obligát intracelluláris?",
        "answers": [ { "text": "Chlamydia pneumoniae", "correct": true }, { "text": "Escherichia coli", "correct": false }, { "text": "Staphylococcus aureus", "correct": false }, { "text": "Klebsiella pneumoniae", "correct": false } ]
    },
    // Mikrobiológiai - Nehéz
    {
        "id": 11, "topic": "microbiological", "difficulty": "hard", "question": "Melyik az elsőként választandó szer MRSA ellen?",
        "answers": [ { "text": "Vancomycin", "correct": true }, { "text": "Penicillin G", "correct": false }, { "text": "Amoxicillin", "correct": false }, { "text": "Ceftriaxone", "correct": false } ]
    },
    {
        "id": 12, "topic": "microbiological", "difficulty": "hard", "question": "Melyik az elsőként választandó szer <i>Clostridioides difficile</i> ellen?",
        "answers": [ { "text": "Fidaxomicin", "correct": true }, { "text": "Meropenem", "correct": false }, { "text": "Ciprofloxacin", "correct": false }, { "text": "Gentamicin", "correct": false } ]
    },
    {
        "id": 28, "topic": "microbiological", "difficulty": "hard", "question": "Melyik az elsőként választandó szer <i>Enterococcus faecalis</i> ellen (ha érzékeny)?",
        "answers": [ { "text": "Ampicillin", "correct": true }, { "text": "Ceftriaxone", "correct": false }, { "text": "Clindamycin", "correct": false }, { "text": "Meropenem", "correct": false } ]
    },
    {
        "id": 29, "topic": "microbiological", "difficulty": "hard", "question": "Melyik az elsőként választandó szer <i>Listeria monocytogenes</i> ellen?",
        "answers": [ { "text": "Ampicillin + Gentamicin", "correct": true }, { "text": "Vancomycin", "correct": false }, { "text": "Cefepime", "correct": false }, { "text": "Doxycycline", "correct": false } ]
    },
    {
        "id": 30, "topic": "microbiological", "difficulty": "hard", "question": "Melyik az elsőként választandó szer <i>Bacteroides fragilis</i> ellen?",
        "answers": [ { "text": "Metronidazol", "correct": true }, { "text": "Gentamicin", "correct": false }, { "text": "Azithromycin", "correct": false }, { "text": "Ceftriaxone", "correct": false } ]
    },
    ,
    {
        "id": 41, "topic": "microbiological", "difficulty": "hard", "question": "Melyik kórokozó termel ureáz enzimet, ami struvit vesekövek képződéséhez vezethet?",
        "answers": [ { "text": "Proteus mirabilis", "correct": true }, { "text": "Pseudomonas aeruginosa", "correct": false }, { "text": "Serratia marcescens", "correct": false }, { "text": "Enterobacter cloacae", "correct": false } ]
    },
    {
        "id": 42, "topic": "microbiological", "difficulty": "hard", "question": "Melyik antibiotikum-kombináció javasolt *Neisseria gonorrhoeae* fertőzésre a növekvő rezisztencia miatt?",
        "answers": [ { "text": "Ceftriaxone + Azithromycin", "correct": true }, { "text": "Penicillin G + Gentamicin", "correct": false }, { "text": "Amoxicillin", "correct": false }, { "text": "Doxycycline önmagában", "correct": false } ]
    },
    {
        "id": 43, "topic": "pharmacological", "difficulty": "easy", "question": "Melyik antibiotikumot használják gyakran a *Helicobacter pylori* eradikációs terápiában?",
        "answers": [ { "text": "Clarithromycin", "correct": true }, { "text": "Gentamicin", "correct": false }, { "text": "Vancomycin", "correct": false }, { "text": "Cefepime", "correct": false } ]
    },
    {
        "id": 44, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik gyógyszer gátolja a folsavszintézist a dihidrofolát-reduktáz enzimen keresztül?",
        "answers": [ { "text": "Trimethoprim", "correct": true }, { "text": "Sulfamethoxazol", "correct": false }, { "text": "Dapsone", "correct": false }, { "text": "Pyrimethamine", "correct": false } ]
    },
    {
        "id": 45, "topic": "clinical", "difficulty": "easy", "question": "Melyik a leggyakoribb kórokozója a macskakarmolási betegségnek?",
        "answers": [ { "text": "Bartonella henselae", "correct": true }, { "text": "Pasteurella multocida", "correct": false }, { "text": "Capnocytophaga canimorsus", "correct": false }, { "text": "Toxoplasma gondii", "correct": false } ]
    },
    {
        "id": 46, "topic": "clinical", "difficulty": "hard", "question": "Mi az ajánlott terápia a Q-láz krónikus formájában (endocarditis)?",
        "answers": [ { "text": "Doxycycline + Hydroxychloroquine", "correct": true }, { "text": "Csak Doxycycline", "correct": false }, { "text": "Ceftriaxone", "correct": false }, { "text": "Rifampin + Isoniazid", "correct": false } ]
    },
    {
        "id": 47, "topic": "microbiological", "difficulty": "easy", "question": "Melyik kórokozó obligát anaerob?",
        "answers": [ { "text": "Bacteroides fragilis", "correct": true }, { "text": "Escherichia coli", "correct": false }, { "text": "Staphylococcus aureus", "correct": false }, { "text": "Pseudomonas aeruginosa", "correct": false } ]
    },
    {
        "id": 48, "topic": "microbiological", "difficulty": "hard", "question": "Melyik antibiotikum hatástalan a *Mycoplasma pneumoniae* ellen a sejtfal hiánya miatt?",
        "answers": [ { "text": "Penicillin G", "correct": true }, { "text": "Doxycycline", "correct": false }, { "text": "Azithromycin", "correct": false }, { "text": "Levofloxacin", "correct": false } ]
    }
    {
        "id": 49, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik penicillin származék hatékony Pseudomonas aeruginosa ellen?",
        "answers": [ { "text": "Ticarcillin-clavulanate", "correct": true }, { "text": "Amoxicillin", "correct": false }, { "text": "Oxacillin", "correct": false }, { "text": "Penicillin V", "correct": false } ]
    },
    {
        "id": 50, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik karbapenemnek nincs számottevő hatása Pseudomonas aeruginosa ellen?",
        "answers": [ { "text": "Ertapenem", "correct": true }, { "text": "Meropenem", "correct": false }, { "text": "Imipenem", "correct": false }, { "text": "Doripenem", "correct": false } ]
    },
    {
        "id": 51, "topic": "pharmacological", "difficulty": "hard", "question": "Melyik fluorokinolonnak van a legkifejezettebb anaerob hatása, de nincs antipseudomonas aktivitása?",
        "answers": [ { "text": "Moxifloxacin", "correct": true }, { "text": "Ciprofloxacin", "correct": false }, { "text": "Levofloxacin", "correct": false }, { "text": "Ofloxacin", "correct": false } ]
    }
];

// ----- AUTOMATICALLY GENERATED QUESTIONS START -----
(function() {
    if (!window.antibiotics_hu || !window.pathogens_hu || !window.test_hu) {
        console.error("Required data (antibiotics_hu, pathogens_hu, or test_hu) is not available for question generation.");
        return;
    }

    // Helper function to shuffle arrays for randomizing answer order
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // --- Question Type 1: Which group does the antibiotic belong to? ---
    const allGroups = [...new Set(window.antibiotics_hu.map(ab => ab.group.hu))];
    const groupQuestions = window.antibiotics_hu.map(ab => {
        const correctAnswer = ab.group.hu;
        // Get 3 other random groups as distractors
        const wrongAnswers = shuffle(allGroups.filter(g => g !== correctAnswer)).slice(0, 3);
        
        // Ensure we have enough distractors to form a 4-choice question
        if (wrongAnswers.length < 3) return null;

        const answers = shuffle([
            { text: correctAnswer, correct: true },
            ...wrongAnswers.map(wa => ({ text: wa, correct: false }))
        ]);

        return {
            topic: "pharmacological",
            difficulty: "auto-generated", // Mark as auto-generated
            question: `Melyik antibiotikum csoportba tartozik a(z) ${ab.name.hu}?`,
            answers: answers
        };
    }).filter(q => q !== null); // Filter out nulls if there weren't enough distractors

    // --- Question Type 2: Which pathogen is the antibiotic effective against? ---
    const allPathogenNames = window.pathogens_hu.map(p => p.name);
    const spectrumQuestions = [];

    window.pathogens_hu.forEach(pathogen => {
        if (pathogen.firstChoice && pathogen.firstChoice.length > 0) {
            pathogen.firstChoice.forEach(abName => {
                // Find the full antibiotic object to ensure it exists in our antibiotics list
                const antibiotic = window.antibiotics_hu.find(ab => ab.name.hu === abName);
                if (!antibiotic) return; // Skip if this antibiotic isn't in the main list

                const correctAnswer = pathogen.name;
                // Get 3 other random pathogen names as distractors
                const wrongAnswers = shuffle(allPathogenNames.filter(pName => pName !== correctAnswer)).slice(0, 3);

                if (wrongAnswers.length < 3) return; // Ensure we have enough distractors

                const answers = shuffle([
                    { text: correctAnswer, correct: true },
                    ...wrongAnswers.map(wa => ({ text: wa, correct: false }))
                ]);

                spectrumQuestions.push({
                    topic: "microbiological",
                    difficulty: "auto-generated", // Mark as auto-generated
                    question: `Melyik kórokozóra hatásos (első vonalbeli) a(z) ${abName}?`,
                    answers: answers
                });
            });
        }
    });

    // --- Combine and Add to Test Array ---
    const generatedQuestions = [...groupQuestions, ...spectrumQuestions];
    
    // Get the highest existing ID to avoid conflicts
    const lastId = window.test_hu.reduce((max, q) => Math.max(max, q.id || 0), 0);
    
    // Assign unique IDs to the new questions
    generatedQuestions.forEach((q, index) => {
        q.id = lastId + index + 1;
    });

    // Add the new questions to the existing test array
    window.test_hu.push(...generatedQuestions);
    
    console.log(`Successfully generated and added ${generatedQuestions.length} new questions.`);

})();
// ----- AUTOMATICALLY GENERATED QUESTIONS END -----
